<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Analysis in Social Science 3</title>
  <meta name="description" content="A website for the Data Analysis in Social Science 3 module.">
  <meta name="generator" content="bookdown 0.6 and GitBook 2.6.7">

  <meta property="og:title" content="Data Analysis in Social Science 3" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://abessudnov.net/dataanalysis3/" />
  
  <meta property="og:description" content="A website for the Data Analysis in Social Science 3 module." />
  <meta name="github-repo" content="abessudnov/dataanalysis3" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Analysis in Social Science 3" />
  
  <meta name="twitter:description" content="A website for the Data Analysis in Social Science 3 module." />
  

<meta name="author" content="Alexey Bessudnov, expanded and edited by Max Shilling (BSc Sociology student 2018)">


<meta name="date" content="2019-01-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="rmarkdown.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113869422-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-113869422-1');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#things-to-do-before-the-next-class"><i class="fa fa-check"></i><b>1.1</b> Things to do before the next class</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="readdata.html"><a href="readdata.html"><i class="fa fa-check"></i><b>2</b> Read data</a><ul>
<li class="chapter" data-level="2.1" data-path="readdata.html"><a href="readdata.html#introduction-to-reading-data"><i class="fa fa-check"></i><b>2.1</b> Introduction to Reading Data</a></li>
<li class="chapter" data-level="2.2" data-path="readdata.html"><a href="readdata.html#reading-common-data-files-into-r"><i class="fa fa-check"></i><b>2.2</b> Reading common data files into R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="readdata.html"><a href="readdata.html#ways-to-read-data-into-r"><i class="fa fa-check"></i><b>2.2.1</b> Ways to read data into R</a></li>
<li class="chapter" data-level="2.2.2" data-path="readdata.html"><a href="readdata.html#comparing-these-three-methods"><i class="fa fa-check"></i><b>2.2.2</b> Comparing these three methods</a></li>
<li class="chapter" data-level="2.2.3" data-path="readdata.html"><a href="readdata.html#editing-a-dataset-while-reading-it-into-r"><i class="fa fa-check"></i><b>2.2.3</b> Editing a dataset while reading it into R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="readdata.html"><a href="readdata.html#reading-other-data-files"><i class="fa fa-check"></i><b>2.3</b> Reading other data files</a><ul>
<li class="chapter" data-level="2.3.1" data-path="readdata.html"><a href="readdata.html#excel"><i class="fa fa-check"></i><b>2.3.1</b> Excel</a></li>
<li class="chapter" data-level="2.3.2" data-path="readdata.html"><a href="readdata.html#spss"><i class="fa fa-check"></i><b>2.3.2</b> SPSS</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="readdata.html"><a href="readdata.html#saving-datasets"><i class="fa fa-check"></i><b>2.4</b> Saving datasets</a><ul>
<li class="chapter" data-level="2.4.1" data-path="readdata.html"><a href="readdata.html#saving-data-as-a-text-file"><i class="fa fa-check"></i><b>2.4.1</b> Saving data as a text file</a></li>
<li class="chapter" data-level="2.4.2" data-path="readdata.html"><a href="readdata.html#saving-data-as-an-excel-file"><i class="fa fa-check"></i><b>2.4.2</b> Saving data as an Excel file</a></li>
<li class="chapter" data-level="2.4.3" data-path="readdata.html"><a href="readdata.html#saving-data-as-an-spss-file"><i class="fa fa-check"></i><b>2.4.3</b> Saving data as an SPSS file</a></li>
<li class="chapter" data-level="2.4.4" data-path="readdata.html"><a href="readdata.html#saving-an-object-as-an-rds-file"><i class="fa fa-check"></i><b>2.4.4</b> Saving an object as an RDS file</a></li>
<li class="chapter" data-level="2.4.5" data-path="readdata.html"><a href="readdata.html#loading-these-datasets-back-into-r"><i class="fa fa-check"></i><b>2.4.5</b> Loading these datasets back into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="readdata.html"><a href="readdata.html#saving-the-working-environment"><i class="fa fa-check"></i><b>2.5</b> Saving the working environment</a></li>
<li class="chapter" data-level="2.6" data-path="readdata.html"><a href="readdata.html#reading-in-multiple-waves-from-understanding-society"><i class="fa fa-check"></i><b>2.6</b> Reading in multiple waves from Understanding Society</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="transformdata.html"><a href="transformdata.html"><i class="fa fa-check"></i><b>3</b> Transform data</a><ul>
<li class="chapter" data-level="3.1" data-path="transformdata.html"><a href="transformdata.html#introduction-to-transforming-data"><i class="fa fa-check"></i><b>3.1</b> Introduction to transforming data</a></li>
<li class="chapter" data-level="3.2" data-path="transformdata.html"><a href="transformdata.html#operators-recap"><i class="fa fa-check"></i><b>3.2</b> Operators recap</a><ul>
<li class="chapter" data-level="3.2.1" data-path="transformdata.html"><a href="transformdata.html#relational-operators"><i class="fa fa-check"></i><b>3.2.1</b> Relational operators</a></li>
<li class="chapter" data-level="3.2.2" data-path="transformdata.html"><a href="transformdata.html#logical-operators"><i class="fa fa-check"></i><b>3.2.2</b> Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="transformdata.html"><a href="transformdata.html#the-pipe-operator"><i class="fa fa-check"></i><b>3.3</b> The pipe operator (%&gt;%)</a></li>
<li class="chapter" data-level="3.4" data-path="transformdata.html"><a href="transformdata.html#select-variables"><i class="fa fa-check"></i><b>3.4</b> Select variables</a></li>
<li class="chapter" data-level="3.5" data-path="transformdata.html"><a href="transformdata.html#select-cases"><i class="fa fa-check"></i><b>3.5</b> Select cases</a></li>
<li class="chapter" data-level="3.6" data-path="transformdata.html"><a href="transformdata.html#recode-variables-both-base-r-and-dplyr-using-ifelse"><i class="fa fa-check"></i><b>3.6</b> Recode variables Both base R and dplyr using ifelse</a></li>
<li class="chapter" data-level="3.7" data-path="transformdata.html"><a href="transformdata.html#create-new-variables"><i class="fa fa-check"></i><b>3.7</b> Create new variables</a></li>
<li class="chapter" data-level="3.8" data-path="transformdata.html"><a href="transformdata.html#sort-data"><i class="fa fa-check"></i><b>3.8</b> Sort data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="joining.html"><a href="joining.html"><i class="fa fa-check"></i><b>4</b> Join data</a><ul>
<li class="chapter" data-level="4.1" data-path="joining.html"><a href="joining.html#introduction-to-joining-data"><i class="fa fa-check"></i><b>4.1</b> Introduction to joining data</a></li>
<li class="chapter" data-level="4.2" data-path="joining.html"><a href="joining.html#joining-waves-1-and-2"><i class="fa fa-check"></i><b>4.2</b> Joining waves 1 and 2</a><ul>
<li class="chapter" data-level="4.2.1" data-path="joining.html"><a href="joining.html#the-key"><i class="fa fa-check"></i><b>4.2.1</b> The ‘key’</a></li>
<li class="chapter" data-level="4.2.2" data-path="joining.html"><a href="joining.html#inner-join"><i class="fa fa-check"></i><b>4.2.2</b> Inner join</a></li>
<li class="chapter" data-level="4.2.3" data-path="joining.html"><a href="joining.html#left-join"><i class="fa fa-check"></i><b>4.2.3</b> Left join</a></li>
<li class="chapter" data-level="4.2.4" data-path="joining.html"><a href="joining.html#right-join"><i class="fa fa-check"></i><b>4.2.4</b> Right join</a></li>
<li class="chapter" data-level="4.2.5" data-path="joining.html"><a href="joining.html#full-join"><i class="fa fa-check"></i><b>4.2.5</b> Full join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>5</b> Iteration</a><ul>
<li class="chapter" data-level="5.1" data-path="iteration.html"><a href="iteration.html#introduction-to-iteration"><i class="fa fa-check"></i><b>5.1</b> Introduction to iteration</a><ul>
<li class="chapter" data-level="5.1.1" data-path="iteration.html"><a href="iteration.html#the-for-loop"><i class="fa fa-check"></i><b>5.1.1</b> The <em>for</em> loop</a></li>
<li class="chapter" data-level="5.1.2" data-path="iteration.html"><a href="iteration.html#the-while-loop"><i class="fa fa-check"></i><b>5.1.2</b> The <em>while</em> loop</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="iteration.html"><a href="iteration.html#loading-understanding-society-using-iteration"><i class="fa fa-check"></i><b>5.2</b> Loading <em>Understanding Society</em> using iteration</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>6</b> Tidy data</a><ul>
<li class="chapter" data-level="6.1" data-path="tidy-data.html"><a href="tidy-data.html#long-and-wide-formats"><i class="fa fa-check"></i><b>6.1</b> Long and wide formats</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tidy-data.html"><a href="tidy-data.html#reshaping-the-data"><i class="fa fa-check"></i><b>6.1.1</b> Reshaping the data</a></li>
<li class="chapter" data-level="6.1.2" data-path="tidy-data.html"><a href="tidy-data.html#reshaping-the-data-using-the-reshape2-package"><i class="fa fa-check"></i><b>6.1.2</b> Reshaping the data using the reshape2 package</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tidy-data.html"><a href="tidy-data.html#exercise"><i class="fa fa-check"></i><b>6.2</b> Exercise:</a><ul>
<li class="chapter" data-level="6.2.1" data-path="tidy-data.html"><a href="tidy-data.html#solution"><i class="fa fa-check"></i><b>6.2.1</b> Solution:</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tidy-data.html"><a href="tidy-data.html#cleaning-the-data"><i class="fa fa-check"></i><b>6.3</b> Cleaning the data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="datavis.html"><a href="datavis.html"><i class="fa fa-check"></i><b>7</b> Data visualisation</a><ul>
<li class="chapter" data-level="7.1" data-path="datavis.html"><a href="datavis.html#reading-in-the-data"><i class="fa fa-check"></i><b>7.1</b> Reading in the data</a></li>
<li class="chapter" data-level="7.2" data-path="datavis.html"><a href="datavis.html#visualising-one-quantitative-variable"><i class="fa fa-check"></i><b>7.2</b> Visualising one quantitative variable</a><ul>
<li class="chapter" data-level="7.2.1" data-path="datavis.html"><a href="datavis.html#histogram."><i class="fa fa-check"></i><b>7.2.1</b> Histogram.</a></li>
<li class="chapter" data-level="7.2.2" data-path="datavis.html"><a href="datavis.html#density-chart."><i class="fa fa-check"></i><b>7.2.2</b> Density chart.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="datavis.html"><a href="datavis.html#visualising-one-categorical-variable"><i class="fa fa-check"></i><b>7.3</b> Visualising one categorical variable</a><ul>
<li class="chapter" data-level="7.3.1" data-path="datavis.html"><a href="datavis.html#bar-plot."><i class="fa fa-check"></i><b>7.3.1</b> Bar plot.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="datavis.html"><a href="datavis.html#visualising-two-quantitative-variables"><i class="fa fa-check"></i><b>7.4</b> Visualising two quantitative variables</a></li>
<li class="chapter" data-level="7.5" data-path="datavis.html"><a href="datavis.html#visualising-one-categorical-and-one-quantitative-variable"><i class="fa fa-check"></i><b>7.5</b> Visualising one categorical and one quantitative variable</a></li>
<li class="chapter" data-level="7.6" data-path="datavis.html"><a href="datavis.html#visualising-two-categorical-variables"><i class="fa fa-check"></i><b>7.6</b> Visualising two categorical variables</a></li>
<li class="chapter" data-level="7.7" data-path="datavis.html"><a href="datavis.html#showing-the-relationships-by-group"><i class="fa fa-check"></i><b>7.7</b> Showing the relationships by group</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="datavis2.html"><a href="datavis2.html"><i class="fa fa-check"></i><b>8</b> Data visualisation 2</a><ul>
<li class="chapter" data-level="8.1" data-path="datavis2.html"><a href="datavis2.html#visualising-income"><i class="fa fa-check"></i><b>8.1</b> Visualising income</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>9</b> R Markdown</a></li>
<li class="chapter" data-level="10" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>10</b> Modelling</a><ul>
<li class="chapter" data-level="10.1" data-path="modelling.html"><a href="modelling.html#cross-sectional-analysis"><i class="fa fa-check"></i><b>10.1</b> Cross-sectional analysis</a><ul>
<li class="chapter" data-level="10.1.1" data-path="modelling.html"><a href="modelling.html#age-and-political-interest"><i class="fa fa-check"></i><b>10.1.1</b> Age and political interest</a></li>
<li class="chapter" data-level="10.1.2" data-path="modelling.html"><a href="modelling.html#sex-and-political-interest"><i class="fa fa-check"></i><b>10.1.2</b> Sex and political interest</a></li>
<li class="chapter" data-level="10.1.3" data-path="modelling.html"><a href="modelling.html#linear-model"><i class="fa fa-check"></i><b>10.1.3</b> Linear model</a></li>
<li class="chapter" data-level="10.1.4" data-path="modelling.html"><a href="modelling.html#interaction-effect-between-sex-and-age"><i class="fa fa-check"></i><b>10.1.4</b> Interaction effect between sex and age</a></li>
<li class="chapter" data-level="10.1.5" data-path="modelling.html"><a href="modelling.html#checking-the-assumptions"><i class="fa fa-check"></i><b>10.1.5</b> Checking the assumptions</a></li>
<li class="chapter" data-level="10.1.6" data-path="modelling.html"><a href="modelling.html#presenting-the-output-for-multiple-regression-models"><i class="fa fa-check"></i><b>10.1.6</b> Presenting the output for multiple regression models</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="modelling.html"><a href="modelling.html#longitudinal-analysis"><i class="fa fa-check"></i><b>10.2</b> Longitudinal analysis</a><ul>
<li class="chapter" data-level="10.2.1" data-path="modelling.html"><a href="modelling.html#simple-model"><i class="fa fa-check"></i><b>10.2.1</b> Simple model</a></li>
<li class="chapter" data-level="10.2.2" data-path="modelling.html"><a href="modelling.html#adding-a-time-constant-variable"><i class="fa fa-check"></i><b>10.2.2</b> Adding a time-constant variable</a></li>
<li class="chapter" data-level="10.2.3" data-path="modelling.html"><a href="modelling.html#adding-a-time-varying-variable"><i class="fa fa-check"></i><b>10.2.3</b> Adding a time-varying variable</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="modelling.html"><a href="modelling.html#further-reading"><i class="fa fa-check"></i><b>10.3</b> Further reading</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in Social Science 3</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling" class="section level1">
<h1><span class="header-section-number">10</span> Modelling</h1>
<blockquote>
<p>Pre-requisite for this class: ch.22-24 (“Model”) from R for Data Science - <a href="http://r4ds.had.co.nz/model-intro.html" class="uri">http://r4ds.had.co.nz/model-intro.html</a></p>
</blockquote>
<p>Let us explore how we can apply linear models with the Understanding Society data for your reports.</p>
<p>First we need to read in the data. This is the same data frame that I used for Data visualisation 2. I saved it then so now I can simply open the file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
UndSoc &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;myData/all7clean.rds&quot;</span>)</code></pre></div>
<p>We have a variable for interest in politics (<strong>vote6</strong>) and we will take it as the outcome variable we want to study. It is a discrete variable measured on a four-point scale (from “not at all interested” to “very interested”). It is an ordinal rather than continuous variable so strictly speaking it is not statisticaly appropriate to calculate the mean of this variable and to use simple linear regression. You will see though that we can still do this and learn something interesting from this exercise.</p>
<p>First let us look at the distribution of the variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(UndSoc<span class="op">$</span>vote6)</code></pre></div>
<pre><code>## 
##     fairly not at all   not very       very 
##     102212      84351      86790      30981</code></pre>
<p>To do the modelling we want to recode it to numeric. I will do this in such a way that larger values indicate stronger interest in politics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UndSoc &lt;-<span class="st"> </span>UndSoc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">polinterest =</span> <span class="kw">recode</span>(vote6, 
                              <span class="st">&quot;very&quot;</span> =<span class="st"> &quot;4&quot;</span>, <span class="st">&quot;fairly&quot;</span> =<span class="st"> &quot;3&quot;</span>,
                              <span class="st">&quot;not very&quot;</span> =<span class="st"> &quot;2&quot;</span>, <span class="st">&quot;not al all&quot;</span> =<span class="st"> &quot;1&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">polinterest =</span> <span class="kw">as.numeric</span>(polinterest))

<span class="kw">table</span>(UndSoc<span class="op">$</span>polinterest)</code></pre></div>
<pre><code>## 
##      2      3      4 
##  86790 102212  30981</code></pre>
<div id="cross-sectional-analysis" class="section level2">
<h2><span class="header-section-number">10.1</span> Cross-sectional analysis</h2>
<p>Let us start from cross-sectional analysis, i.e. the analysis of the data at one point in time. You can choose any wave to do this; I will go with wave 1.</p>
<p>First I create a separate data frame for wave 1 only.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wave1 &lt;-<span class="st"> </span>UndSoc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(wave <span class="op">==</span><span class="st"> &quot;a&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(dvage))</code></pre></div>
<div id="age-and-political-interest" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Age and political interest</h3>
<p>We will start with the association between age and political interest. It is always a good idea to start with visualisations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wave1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dvage, <span class="dt">y =</span> polinterest)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>()</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<p>I fit a non-parametric smooth here with <strong>geom_smooth</strong>, and the association between age and political interest seems to be non-linear.</p>
<p>We can also fit a regression line and see how well it describes the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wave1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dvage, <span class="dt">y =</span> polinterest)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Up to the age of about 70 years two lines are pretty close and I’d say that the linear function adequately describes the data. However, for people older than 75 the linear assocition is inadequate and provides a really poor fit.</p>
</div>
<div id="sex-and-political-interest" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Sex and political interest</h3>
<p>Let us look at a bar chart showing the association between sex and political interest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wave1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sex, <span class="dt">y =</span> polinterest)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>)</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
<p>We see that mean political interest is somewhat higher for men compared to women.</p>
</div>
<div id="linear-model" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Linear model</h3>
<p>As I said above, the outcome variable is ordinal so fitting a linear model will have some limitations. For our purposes this is fine though.</p>
<p>For your reports you should fit a linear model for ordered and binary outcomes. The linear model for binary outcomes is called the linear probability model. Please do not estimate logit or probit models for the purpose of this assignment. Of course, you cannot fit a linear model for nominal outcomes. If you outcome is nominal (this is unlikely), you should either stay with descriptive statistics and graphs or use a multinomial logit model. You should only do this if you are confident that you know what you are doing.</p>
<p>Now we can fit a simple linear regression model with two predictors: age and sex.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>dvage, wave1)
<span class="kw">summary</span>(m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = polinterest ~ sex + dvage, data = wave1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9617 -0.6462  0.1435  0.3634  1.4375 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.5243012  0.0109096  231.38   &lt;2e-16 ***
## sexmale     0.2103080  0.0073021   28.80   &lt;2e-16 ***
## dvage       0.0023902  0.0002032   11.76   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6796 on 34758 degrees of freedom
##   (16233 observations deleted due to missingness)
## Multiple R-squared:  0.02699,    Adjusted R-squared:  0.02694 
## F-statistic: 482.1 on 2 and 34758 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Both age and sex are highly statistically significant predictors of political interest. Men on average are 0.3 points higher on the political interest scale. For age, a one-year difference is associated with about 0.01 change in political interest (older people are more interested). For two people with the age difference of about 30 years this corresponds to the difference in political interest of about 0.3.</p>
<p>We have seen that the association between age and political interest is non-linear. To model this, we may want to include the quadratic term for age.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>dvage <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(dvage<span class="op">^</span><span class="dv">2</span>), wave1)
<span class="kw">summary</span>(m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = polinterest ~ sex + dvage + I(dvage^2), data = wave1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8971 -0.6681  0.1229  0.3422  1.5046 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.344e+00  2.487e-02  94.245  &lt; 2e-16 ***
## sexmale      2.106e-01  7.295e-03  28.873  &lt; 2e-16 ***
## dvage        1.081e-02  1.065e-03  10.148  &lt; 2e-16 ***
## I(dvage^2)  -8.534e-05  1.060e-05  -8.051 8.44e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.679 on 34757 degrees of freedom
##   (16233 observations deleted due to missingness)
## Multiple R-squared:  0.0288, Adjusted R-squared:  0.02872 
## F-statistic: 343.6 on 3 and 34757 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The quadratic term is statistically significanty indicating a non-linear fit. Note, however, that the coefficients are now more difficult to interpret. We can visualise the association between age and political interest to get some idea of the effect size.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wave1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dvage, <span class="dt">y =</span> polinterest)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
<p>Note that this visualisation does not control for sex.</p>
</div>
<div id="interaction-effect-between-sex-and-age" class="section level3">
<h3><span class="header-section-number">10.1.4</span> Interaction effect between sex and age</h3>
<p>Another question we can ask is whether the association between age and political interest is the same or different for men and women. Note that in the previous model we control for sex, and the coefficient for age represents an averaged association between age and political interest for men and women. It is possible to have a situation where the association is very different for two sexes (for example, for men political interest increases with age and for women it decreases). To check this formally, we can fit a model with an interaction effect.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span>sex <span class="op">*</span><span class="st"> </span>dvage, wave1)
<span class="kw">summary</span>(m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = polinterest ~ sex * dvage, data = wave1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9572 -0.6465  0.1438  0.3634  1.4401 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2.5202621  0.0142701 176.611   &lt;2e-16 ***
## sexmale        0.2188102  0.0206942  10.573   &lt;2e-16 ***
## dvage          0.0024749  0.0002802   8.831   &lt;2e-16 ***
## sexmale:dvage -0.0001787  0.0004070  -0.439    0.661    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6796 on 34757 degrees of freedom
##   (16233 observations deleted due to missingness)
## Multiple R-squared:  0.027,  Adjusted R-squared:  0.02691 
## F-statistic: 321.5 on 3 and 34757 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We see that the interaction effect is indeed statistically significant and negative suggesting that for men the association between age and political interest is weaker.</p>
<p>We can also fit a quadratic model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span>sex <span class="op">*</span><span class="st"> </span>dvage <span class="op">+</span><span class="st"> </span>sex <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(dvage<span class="op">^</span><span class="dv">2</span>), wave1)
<span class="kw">summary</span>(m4)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = polinterest ~ sex * dvage + sex * I(dvage^2), data = wave1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9061 -0.6595  0.1183  0.3506  1.4727 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         2.434e+00  3.404e-02  71.496  &lt; 2e-16 ***
## sexmale             1.827e-02  4.928e-02   0.371  0.71089    
## dvage               6.477e-03  1.462e-03   4.431 9.40e-06 ***
## I(dvage^2)         -4.032e-05  1.445e-05  -2.790  0.00528 ** 
## sexmale:dvage       9.371e-03  2.135e-03   4.389 1.14e-05 ***
## sexmale:I(dvage^2) -9.803e-05  2.127e-05  -4.610 4.05e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6788 on 34755 degrees of freedom
##   (16233 observations deleted due to missingness)
## Multiple R-squared:  0.02941,    Adjusted R-squared:  0.02927 
## F-statistic: 210.6 on 5 and 34755 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The interaction effect is highly statistically significant. To make sense of the association between age and political interest for men and women it is best to visualise this model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wave1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dvage, <span class="dt">y =</span> polinterest, <span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<p>We can see that the lines for men and women are indeed different, although the non-linear pattern of the association is similar for both sexes.</p>
</div>
<div id="checking-the-assumptions" class="section level3">
<h3><span class="header-section-number">10.1.5</span> Checking the assumptions</h3>
<p>In Data Analysis 2 your task was to check the assumptions underlying linear regression models. This is an important step, but it is less relevant for our work in this module. Many of these assumptions are about the distribution of residuals and affect standard errors of regression coefficients. This is very important for small samples, but less important for large samples like the one we have in the Understanding Society where standard errors are usually small compared to regression coefficients and moderate violation of the regression assumpions (such as not normal distribution of the residuals and heteroskedasticity) will not affect the results much. You do not have to show how you have checked the assumptions in your reports (although if you want to do it for yourself this would not hurt).</p>
<p>Another common question is the interpretation of the R-squared coefficient. In Model 4 the R-squared coefficients was about 0.05 suggesting that age and sex can jointly account for about 5% of the variance of political interest. Is this an indication that the model is really poor? Yes, if your task is to build a model that predicts political interest well. This shows that just knowning a person’s age and sex you can only make a wild guess about their level of political interest (this isn’t really surprising).</p>
<p>However, if our task is simply to explore the association between age, sex and political interest rather than to build a model that predicts political interest well, then we should not pay too much attention to R-squared.</p>
</div>
<div id="presenting-the-output-for-multiple-regression-models" class="section level3">
<h3><span class="header-section-number">10.1.6</span> Presenting the output for multiple regression models</h3>
<p>How to present the regression output in your reports? You can of course simply fo <strong>summary(m1)</strong> as we did above, but this does not look really nice. Another way is to use the package <strong>stargazer</strong>. Note that <strong>stargazer</strong> will only work if you knit your reports as pdf rather than Word. To knit as pdf you will need to install LaTeX on your computers (see <a href="https://www.latex-project.org" class="uri">https://www.latex-project.org</a>). This is how the table produced by <strong>stargazer</strong> will look like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stargazer)
<span class="kw">stargazer</span>(m1, m2, m3, m4, <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
polinterest
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
sexmale
</td>
<td>
0.210<sup>***</sup>
</td>
<td>
0.211<sup>***</sup>
</td>
<td>
0.219<sup>***</sup>
</td>
<td>
0.018
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.021)
</td>
<td>
(0.049)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
dvage
</td>
<td>
0.002<sup>***</sup>
</td>
<td>
0.011<sup>***</sup>
</td>
<td>
0.002<sup>***</sup>
</td>
<td>
0.006<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0002)
</td>
<td>
(0.001)
</td>
<td>
(0.0003)
</td>
<td>
(0.001)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
I(dvage2)
</td>
<td>
</td>
<td>
-0.0001<sup>***</sup>
</td>
<td>
</td>
<td>
-0.00004<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.00001)
</td>
<td>
</td>
<td>
(0.00001)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sexmale:dvage
</td>
<td>
</td>
<td>
</td>
<td>
-0.0002
</td>
<td>
0.009<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(0.0004)
</td>
<td>
(0.002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sexmale:I(dvage2)
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-0.0001<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
(0.00002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.524<sup>***</sup>
</td>
<td>
2.344<sup>***</sup>
</td>
<td>
2.520<sup>***</sup>
</td>
<td>
2.434<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.011)
</td>
<td>
(0.025)
</td>
<td>
(0.014)
</td>
<td>
(0.034)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
34,761
</td>
<td>
34,761
</td>
<td>
34,761
</td>
<td>
34,761
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.027
</td>
<td>
0.029
</td>
<td>
0.027
</td>
<td>
0.029
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.027
</td>
<td>
0.029
</td>
<td>
0.027
</td>
<td>
0.029
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.680 (df = 34758)
</td>
<td>
0.679 (df = 34757)
</td>
<td>
0.680 (df = 34757)
</td>
<td>
0.679 (df = 34755)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
482.108<sup>***</sup> (df = 2; 34758)
</td>
<td>
343.604<sup>***</sup> (df = 3; 34757)
</td>
<td>
321.462<sup>***</sup> (df = 3; 34757)
</td>
<td>
210.631<sup>***</sup> (df = 5; 34755)
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="4" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>In your reports you will knit as LaTeX rather than html so you should do something like:</p>
<pre><code>```{r results = 'asis'}
stargazer(m1, m2, m3, m4, type = "latex")
```</pre>
<p></code></p>
<p>The <em>results</em> argument shoud be set to <em>asis</em> so that the results are displayed correctly. Note that <em>type</em> is <em>latex</em>.</p>
<p><strong>stargazer</strong> has many options to customise the tables. Please do experiment with them.</p>
</div>
</div>
<div id="longitudinal-analysis" class="section level2">
<h2><span class="header-section-number">10.2</span> Longitudinal analysis</h2>
<p>Now we may want to model how things change over time (i.e. do longitudinal modelling).</p>
<div id="simple-model" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Simple model</h3>
<p>We will start from simply plotting mean political interest over time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First let us code the variable for year.</span>
UndSoc &lt;-<span class="st"> </span>UndSoc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(wave, <span class="st">&quot;a&quot;</span> =<span class="st"> &quot;2009&quot;</span>,
                       <span class="st">&quot;b&quot;</span> =<span class="st"> &quot;2010&quot;</span>,
                       <span class="st">&quot;c&quot;</span> =<span class="st"> &quot;2011&quot;</span>,
                       <span class="st">&quot;d&quot;</span> =<span class="st"> &quot;2012&quot;</span>,
                       <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;2013&quot;</span>,
                       <span class="st">&quot;f&quot;</span> =<span class="st"> &quot;2014&quot;</span>,
                       <span class="st">&quot;g&quot;</span> =<span class="st"> &quot;2015&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.numeric</span>(year))

UndSoc <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(
      <span class="dt">meanPI =</span> <span class="kw">mean</span>(polinterest, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
    ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> meanPI)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>The model that describes this chart will be the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(year), UndSoc)
<span class="kw">summary</span>(m5)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = polinterest ~ as.factor(year), data = UndSoc)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.7669 -0.7407  0.2440  0.2628  1.2657 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          2.737205   0.003681 743.678  &lt; 2e-16 ***
## as.factor(year)2010  0.009002   0.005131   1.754 0.079354 .  
## as.factor(year)2011 -0.002951   0.005304  -0.556 0.577977    
## as.factor(year)2012  0.003522   0.005405   0.652 0.514670    
## as.factor(year)2013  0.009105   0.005447   1.671 0.094648 .  
## as.factor(year)2014  0.018811   0.005557   3.385 0.000711 ***
## as.factor(year)2015  0.029738   0.005424   5.482 4.21e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6862 on 219976 degrees of freedom
##   (364720 observations deleted due to missingness)
## Multiple R-squared:  0.0002287,  Adjusted R-squared:  0.0002014 
## F-statistic: 8.387 on 6 and 219976 DF,  p-value: 4.063e-09</code></pre>
<p>We can see from this model that in 2011 to 2013 political interest was statistically significantly lower than in 2009, and in 2015 it was statistically significantly higher.</p>
</div>
<div id="adding-a-time-constant-variable" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Adding a time-constant variable</h3>
<p>We may want to check if the change in political interest depends on a time-constant variable such as sex. Was the change in mean political interest similar for men and women?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">UndSoc <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(sex)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(year, sex) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(
      <span class="dt">meanPI =</span> <span class="kw">mean</span>(polinterest, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
    ) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> meanPI, <span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="datan3_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<p>It does not look like there was an interaction between sex and year, but we can check it formally.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(year)<span class="op">*</span>sex, UndSoc)
<span class="kw">summary</span>(m6)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = polinterest ~ as.factor(year) * sex, data = UndSoc)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8686 -0.6524  0.1492  0.3580  1.3670 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  2.6382492  0.0050051 527.109  &lt; 2e-16 ***
## as.factor(year)2010          0.0141597  0.0069812   2.028   0.0425 *  
## as.factor(year)2011         -0.0052163  0.0072341  -0.721   0.4709    
## as.factor(year)2012          0.0037539  0.0073914   0.508   0.6115    
## as.factor(year)2013         -0.0009026  0.0074550  -0.121   0.9036    
## as.factor(year)2014          0.0167203  0.0075943   2.202   0.0277 *  
## as.factor(year)2015          0.0365789  0.0073908   4.949 7.45e-07 ***
## sexmale                      0.2098474  0.0072886  28.791  &lt; 2e-16 ***
## as.factor(year)2010:sexmale -0.0114441  0.0101599  -1.126   0.2600    
## as.factor(year)2011:sexmale  0.0021654  0.0105007   0.206   0.8366    
## as.factor(year)2012:sexmale -0.0052459  0.0106972  -0.490   0.6239    
## as.factor(year)2013:sexmale  0.0153998  0.0107808   1.428   0.1532    
## as.factor(year)2014:sexmale  0.0002630  0.0109983   0.024   0.9809    
## as.factor(year)2015:sexmale -0.0160510  0.0107396  -1.495   0.1350    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6784 on 219968 degrees of freedom
##   (364721 observations deleted due to missingness)
## Multiple R-squared:  0.02307,    Adjusted R-squared:  0.02301 
## F-statistic: 399.5 on 13 and 219968 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>This suggest that the gap in political interest between men and women was slighty hgher in 2013, but the effect size is really small.</p>
</div>
<div id="adding-a-time-varying-variable" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Adding a time-varying variable</h3>
<p>Things get more tricky (and more interesting) if we want to add a time-varying variable such as age to the analysis. We have already modelled the association between age and political interest cross-sectionally. This answers the question of whether there is any difference in political interest between people of different age.</p>
<p>Another question that we may want to ask is whether political interest changes when people get older. Note that this is a different question, and answering it requires the use of longitudinal data.</p>
<p>To answer this question we need to apply regression models with fixed effects. You have not covered these models in Data Analysis 2. The main idea is to look at the changes for the same individuals. We want to see if for each person in the data getting older is associated with the changes in political interest, and then we can average the effects across different people. In other words, instead of fitting the model that compares <em>between</em> individuals we want to compare <em>within</em> individuals.</p>
<p>Technically, we can achieve this by simply controlling for individual id.</p>
<p>With the data of our size the model will be very difficult to estimate, so for the demonstration purposes I will select 500 random individuals from the data and run the model for them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># creating a data frame with data for 500 random people</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
random500 &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">unique</span>(UndSoc<span class="op">$</span>pidp), <span class="dv">500</span>)
UndSoc500 &lt;-<span class="st"> </span>UndSoc <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(pidp <span class="op">%in%</span><span class="st"> </span>random500)

m7 &lt;-<span class="st"> </span><span class="kw">lm</span>(polinterest <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(year) <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(pidp) <span class="op">+</span><span class="st"> </span>dvage, UndSoc500)</code></pre></div>
<p>If we run <strong>summary(m7)</strong> now we will get a really long output with 499 coefficients for <strong>pidp</strong>. I will use <strong>stargazer</strong> to present the results and will omit these coefficients (called individual fixed effects) and the coefficients for year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(m7, <span class="dt">omit =</span> <span class="kw">c</span>(<span class="st">&quot;pidp&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
polinterest
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
dvage
</td>
<td>
0.048
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.071)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.867
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(4.246)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
1,338
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.697
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.574
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.452 (df = 950)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
5.655<sup>***</sup> (df = 387; 950)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Note that the coefficient for age is not statisticaly significant. This indicates that as people get older their interest in politics does not change much, at least in our sub-sample of 500 people.</p>
<p>A more efficient way to estimate fixed effects model is to use the package <strong>plm</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plm)
m8 &lt;-<span class="st"> </span><span class="kw">plm</span>(polinterest <span class="op">~</span><span class="st"> </span>dvage, <span class="dt">data =</span> UndSoc500, <span class="dt">model =</span> <span class="st">&quot;within&quot;</span>, <span class="dt">index =</span> <span class="kw">c</span>(<span class="st">&quot;pidp&quot;</span>, <span class="st">&quot;year&quot;</span>),
          <span class="dt">effect =</span> <span class="st">&quot;twoways&quot;</span>)
<span class="kw">summary</span>(m8)</code></pre></div>
<pre><code>## Twoways effects Within Model
## 
## Call:
## plm(formula = polinterest ~ dvage, data = UndSoc500, effect = &quot;twoways&quot;, 
##     model = &quot;within&quot;, index = c(&quot;pidp&quot;, &quot;year&quot;))
## 
## Unbalanced Panel: n = 381, T = 1-7, N = 1338
## 
## Residuals:
##     Min.  1st Qu.   Median  3rd Qu.     Max. 
## -1.49866 -0.19252  0.00000  0.17069  1.50937 
## 
## Coefficients:
##       Estimate Std. Error t-value Pr(&gt;|t|)
## dvage 0.048088   0.070771  0.6795    0.497
## 
## Total Sum of Squares:    193.86
## Residual Sum of Squares: 193.77
## R-Squared:      0.00048575
## Adj. R-Squared: -0.40668
## F-statistic: 0.461689 on 1 and 950 DF, p-value: 0.497</code></pre>
<p>Asking for the <strong>twoways</strong> effect means that we fit the model with individual and year fixed effects.</p>
<p>Note that the effect size is exactly the same in models 7 and 8 (becuase this is essentially the same model), but <strong>plm</strong> will work faster. With <strong>plm</strong> you may be able to estimate the fixed effects model with the full data for your reports, although the estimation will take you some time. I will not do this here.</p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2><span class="header-section-number">10.3</span> Further reading</h2>
<p>If you want to use linear models in your assignment I strongly recommend you consult the following book (available as an e-book in the library):</p>
<ol style="list-style-type: decimal">
<li>J.Fox, S.Weisberg. (2011). An R Companion to Applied Regression. 2nd ed. Sage.</li>
</ol>
<p>The chapter on factors and interactions will be particularly useful.</p>
<p>If you want to know more about fixed effects models see</p>
<ol start="2" style="list-style-type: decimal">
<li>P.D.Allison. (2008). Fixed Effect Regression Models. Sage.</li>
</ol>
<p>To learn how to use the package <strong>plm</strong> read</p>
<ol start="3" style="list-style-type: decimal">
<li>Y.Croissant, G.Millo. Panel Data Econometrics in R: The plm Package. <a href="https://cran.r-project.org/web/packages/plm/vignettes/plm.pdf" class="uri">https://cran.r-project.org/web/packages/plm/vignettes/plm.pdf</a></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rmarkdown.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
